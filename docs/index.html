<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Vehicular Emissions Inventories • vein</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Vehicular Emissions Inventories">
<meta property="og:description" content="Elaboration of vehicular emissions inventories,
    consisting in four stages, pre-processing activity data, preparing 
    emissions factors, estimating the emissions and post-processing of emissions 
    in maps and databases. More details in Ibarra-Espinosa et al (2018) &lt;doi:10.5194/gmd-11-2209-2018&gt;.
    Before ussing VEIN you need to know the vehicular composition of your study area, in other words,
    the combination of of type of vehicles, size and fuel of the fleet. Then, it is recommended to
    start with the function inventory to create a structure of directories and template scripts.">
<meta property="og:image" content="http://ibarraespinosa.github.io/vein/logo.png">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">vein</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.6.9</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li>
  <a href="news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    

    
    

<div id="vehicular-emissions-inventory-vein-model-" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#vehicular-emissions-inventory-vein-model-" class="anchor"></a><strong>V</strong>ehicular <strong>E</strong>missions <strong>IN</strong>ventory <strong>(VEIN)</strong> model. <img src="https://i.imgur.com/dp8spyp.png">
</h1></div>
<p>You can learn more about VEIN reading the documentation in <a href="https://cran.r-project.org/web/packages/vein/vein.pdf">PDF</a>, <a href="https://atmoschem.github.io/vein/">online</a>, reading the book <a href="https://ibarraespinosa.github.io/VEINBOOK/">online</a>, or buy it in <a href="https://www.amazon.com/VEINBOOK-Estimating-vehicular-emissions-package-ebook-dp-B07L7XRFKC/dp/B07L7XRFKC/ref=mt_kindle?_encoding=UTF8&amp;me=&amp;qid=">Kindle</a> or <a href="https://www.amazon.com/gp/product/1791571158?pf_rd_p=1581d9f4-062f-453c-b69e-0f3e00ba2652&amp;pf_rd_r=EMDPZM3G7BWCHAD9F4QP">Paperback</a></p>
<div class="figure">
<img src="https://i.imgur.com/RcfNmDm.jpg">
</div>
<div id="what-is-vein" class="section level2">
<h2 class="hasAnchor">
<a href="#what-is-vein" class="anchor"></a>What is VEIN?</h2>
<p>Vehicular Emissions Inventories. An R package to estimate vehicular emissions. It currently covers the following pollutants in speed functions:</p>
<div id="european-emission-factors-for-all-available-vehicle-categories" class="section level3">
<h3 class="hasAnchor">
<a href="#european-emission-factors-for-all-available-vehicle-categories" class="anchor"></a>European emission factors for all available vehicle categories:</h3>
<ul>
<li>
<strong>Criteria (g/km)</strong>: “CO”, “NOx”, “HC”, “PM”, “CH4”, “NMHC”, “CO2”, “SO2”, “Pb”, “FC” (Fuel Consumption),“NO”, “NO2”.</li>
<li>
<strong>PAH and POP</strong>: “indeno(1,2,3-cd)pyrene”, “benzo(k)fluoranthene”, “benzo(b)fluoranthene”, “benzo(ghi)perylene”, “fluoranthene”, “benzo(a)pyrene”, “pyrene”, “perylene”, “anthanthrene”, “benzo(b)fluorene”, “benzo(e)pyrene”, “triphenylene”, “benzo(j)fluoranthene”, “dibenzo(a,j)anthacene”, “dibenzo(a,l)pyrene”, “THREE_6-dimethyl-phenanthrene”, “benzo(a)anthracene”, “acenaphthylene”, “acenapthene”, “fluorene”, “chrysene”, “phenanthrene”, “napthalene”, “anthracene”, “coronene”, “dibenzo(ah)anthracene”</li>
<li>
<strong>Dioxins and Furans (g/km)</strong>: “PCDD”, “PCDF”, “PCB”.</li>
<li>
<strong>Metals (g/km)</strong>: “As”, “Cd”, “Cr”, “Cu”, “Hg”, “Ni”, “Pb”, “Se”, “Zn”.</li>
<li>
<strong>NMHC (g/km)</strong>:</li>
<li>
<em>ALKANES</em>: “ethane”, “propane”, “butane”, “isobutane”, “pentane”, “isopentane”, “hexane”, “heptane”, “octane”, “TWO_methylhexane”, “nonane”, “TWO_methylheptane”, “THREE_methylhexane”, “decane”, “THREE_methylheptane”, “alcanes_C10_C12”, “alkanes_C13”.</li>
<li>
<em>CYCLOALKANES</em>: “cycloalcanes”.</li>
<li>
<em>ALKENES</em>: “ethylene”, “propylene”, “propadiene”, “ONE_butene”, “isobutene”, “TWO_butene”, “ONE_3_butadiene”, “ONE_pentene”, “TWO_pentene”, “ONE_hexene”, “dimethylhexene”.</li>
<li>
<em>ALKYNES</em>:“ONE_butine”, “propine”, “acetylene”.</li>
<li>
<em>ALDEHYDES</em>: “formaldehyde”, “acetaldehyde”, “acrolein”, “benzaldehyde”, “crotonaldehyde”, “methacrolein”, “butyraldehyde”, “isobutanaldehyde”, “propionaldehyde”, “hexanal”, “i_valeraldehyde”, “valeraldehyde”, “o_tolualdehyde”, “m_tolualdehyde”, “p_tolualdehyde”.</li>
<li>KETONES: “acetone”, “methylethlketone”.</li>
<li>
<em>AROMATICS</em>: “toluene”, “ethylbenzene”, “m_p_xylene”, “o_xylene”, “ONE_2_3_trimethylbenzene”, “ONE_2_4_trimethylbenzene”, “ONE_3_5_trimethylbenzene”, “styrene”, “benzene”, “C9”, “C10”, “C13”.</li>
<li><strong>Active Surface (cm2/km)</strong></li>
<li>“AS_urban”, “AS_rural”, “AS_highway”.</li>
<li><strong>Total Number of particles (N/km)</strong></li>
<li>“N_urban”, “N_rural”, “N_highway”, “N_50nm_urban”, “N_50_100nm_rural”, “N_100_1000nm_highway”.</li>
</ul>
</div>
<div id="brazilian-emission-factors-for-all-available-vehicle-categories" class="section level3">
<h3 class="hasAnchor">
<a href="#brazilian-emission-factors-for-all-available-vehicle-categories" class="anchor"></a>Brazilian emission factors for all available vehicle categories:</h3>
<ul>
<li>“COd”, “HCd”, “NMHCd”, “CH4”, “NOxd”, “CO2” “PM”, “N2O”, “KML”, “FC”, “NO2d”, “NOd”, “gCO2/KWH”, “RCHOd”, “CO”, “HC”, “NMHC”, “NOx”, “NO2” ,“NO”, “RCHO”</li>
</ul>
</div>
<div id="brazilian-speciation-based-on-iagusp-fatimas-group-studies" class="section level3">
<h3 class="hasAnchor">
<a href="#brazilian-speciation-based-on-iagusp-fatimas-group-studies" class="anchor"></a>Brazilian speciation based on IAG/USP (Fátima’s group) studies:</h3>
<ul>
<li>“e_eth”, “e_hc3”, “e_hc5”, “e_hc8”, “e_ol2”, “e_olt”, “e_oli”, “e_iso”, “e_tol”, “e_xyl”, “e_c2h5oh”, “e_ald”, “e_hcho”, “e_ch3oh”, “e_ket”, “E_SO4i”, “E_SO4j”, “E_NO3i”, “E_NO3j”, “E_MP2.5i”, “E_MP2.5j”, “E_ORGi”, “E_ORGj”, “E_ECi”, “E_ECj”</li>
</ul>
</div>
<div id="base-emission-factors-from-international-emission-model-ive-for-all-available-vehicle-categories" class="section level3">
<h3 class="hasAnchor">
<a href="#base-emission-factors-from-international-emission-model-ive-for-all-available-vehicle-categories" class="anchor"></a>Base emission factors from International Emission Model (IVE) for all available vehicle categories:</h3>
<ul>
<li>“VOC_gkm”, “CO_gkm”, “NOx_gkm”, “PM_gkm”, “Pb_gkm”, “SO2_gkm”, “NH3_gkm”, “ONE_3_butadiene_gkm”, “formaldehyde_gkm”, “acetaldehyde_gkm”, “benzene_gkm”, “EVAP_gkm”, “CO2_gkm”, “N20_gkm”, “CH4_gkm”, “VOC_gstart”, “CO_gstart”, “NOx_gstart”, “PM_gstart”, “Pb_gstart”, “SO2_gstart”, “NH3_gstart”, “ONE_3butadiene_gstart”, “formaldehyde_gstart”,“acetaldehyde_gstart”, “benzene_gstart”, “EVAP_gstart”, “CO2_gstart”, “N20_gstart”, “CH4_gstart”</li>
</ul>
</div>
<div id="system-requirements" class="section level3">
<h3 class="hasAnchor">
<a href="#system-requirements" class="anchor"></a>System requirements</h3>
<p>vein imports functions from spatial packages listed below. In order to install these packages, firstly the user must install the requirements mentioned <a href="https://www.github.com/r-spatial/sf">here</a>.</p>
</div>
<div id="packages-needed" class="section level3">
<h3 class="hasAnchor">
<a href="#packages-needed" class="anchor"></a>Packages needed</h3>
<p>After installing system dependencies, you will need these packages:</p>
<ul>
<li><a href="https://github.com/r-spatial/sf">sf</a></li>
<li><a href="https://github.com/edzer/sp/">sp</a></li>
<li><a href="https://github.com/r-spatial/lwgeom/">lwgeom</a></li>
<li><a href="https://github.com/edzer/units/">units</a></li>
<li><a href="https://github.com/atmoschem/eixport/">eixport</a></li>
</ul>
<p>In order to run the demo, this package is also needed:</p>
<ul>
<li><a href="https://github.com/tidyverse/ggplot2">ggplot2</a></li>
</ul>
</div>
<div id="installation" class="section level3">
<h3 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h3>
<p>VEIN can be installed via CRAN or github</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(remotes) 
<span class="kw"><a href="https://www.rdocumentation.org/packages/remotes/topics/install_github">install_github</a></span>(<span class="st">"atmoschem/vein"</span>)
<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(vein)
<span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/demo">demo</a></span>(VEIN)</code></pre></div>
<p>or</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/install.packages">install.packages</a></span>(<span class="st">"vein"</span>)
<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(vein)
<span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/demo">demo</a></span>(VEIN)</code></pre></div>
</div>
</div>
<div id="what-is-new-0-6-0" class="section level2">
<h2 class="hasAnchor">
<a href="#what-is-new-0-6-0" class="anchor"></a>What is new? 0.6.0</h2>
<ul>
<li>
<a href="https://atmoschem.github.io/vein/reference/grid_emis.html">grid_emis</a> To allocate gridded emissions to streets by grid cell.</li>
<li>
<a href="https://atmoschem.github.io/vein/reference/matvect.html">matvect</a> To multiply matrices with vectors.</li>
<li>Add Active Surface (cm2/km): “AS_urban”, “AS_rural”, “AS_highway”.</li>
<li>Add number of particles (N/km): “N_urban”, “N_rural”, “N_highway”, “N_50nm_urban”, “N_50_100nm_rural”, “N_100_1000nm_highway”.</li>
<li>Fix minor bugs.</li>
<li>Check the <a href="https://github.com/atmoschem/vein/blob/master/NEWS.md">NEWS</a>
</li>
</ul>
<p>future steps:</p>
<ul>
<li>Enhance <a href="https://atmoschem.github.io/vein/reference/inventory.html">inventory</a>.</li>
<li>Add a standard fleet categorization.</li>
<li>Add HBEFA EF.</li>
<li>Fortran.</li>
<li>Estimation of evaporative emissions with Copert Tier 3.</li>
<li>Group species by chemical mechanism.</li>
</ul>
</div>
<div id="how-does-it-work" class="section level2">
<h2 class="hasAnchor">
<a href="#how-does-it-work" class="anchor"></a>How does it work?</h2>
<p>VEIN consist of: “Elaboration of vehicular emissions inventories, consisting in four stages:</p>
<ol style="list-style-type: decimal">
<li>pre-processing activity data,</li>
<li>preparing emissions factors,</li>
<li>estimating the emissions and</li>
<li>post-processing of emissions in maps and databases."</li>
</ol>
<p>This implies the use of several functions in a coordinates ans structured way, therefore it is added the new function <strong>inventory</strong> which creates a structured set of directories and scripts to run VEIN. Please, open the file ‘main.R’ and run each line to understand VEIN. <strong>Remember, if you have doubts with any function, just type ‘?’ with the name of the function. For intance: <code><a href="reference/inventory.html">?inventory</a></code>.</strong></p>
<p>Using <a href="https://atmoschem.github.io/vein/reference/inventory.html">inventory</a></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(vein)
<span class="kw"><a href="reference/inventory.html">inventory</a></span>(<span class="dt">name =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/file.path">file.path</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/tempfile">tempdir</a></span>(), <span class="st">"YourCity"</span>), 
          <span class="dt">vehcomp =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dt">PC =</span> <span class="dv">1</span>, <span class="dt">LCV =</span> <span class="dv">1</span>, <span class="dt">HGV =</span> <span class="dv">1</span>, <span class="dt">BUS =</span> <span class="dv">1</span>, <span class="dt">MC =</span> <span class="dv">1</span>),
          <span class="dt">show.dir =</span> T, 
          <span class="dt">show.scripts =</span> T)</code></pre></div>
<pre><code>files at /tmp/RtmpEorTs8/YourCity
Directories:
 [1] "/tmp/RtmpEorTs8/YourCity"              
 [2] "/tmp/RtmpEorTs8/YourCity/ef"           
 [3] "/tmp/RtmpEorTs8/YourCity/emi"          
 [4] "/tmp/RtmpEorTs8/YourCity/emi/BUS_01"  
 [5] "/tmp/RtmpEorTs8/YourCity/emi/HGV_01"   
 [6] "/tmp/RtmpEorTs8/YourCity/emi/LCV_01"  
 [7] "/tmp/RtmpEorTs8/YourCity/emi/MC_01"    
 [8] "/tmp/RtmpEorTs8/YourCity/emi/PC_01"   
 [9] "/tmp/RtmpEorTs8/YourCity/est"          
 [10] "/tmp/RtmpEorTs8/YourCity/images"       
 [11] "/tmp/RtmpEorTs8/YourCity/network"      
 [12] "/tmp/RtmpEorTs8/YourCity/post"        
 [13] "/tmp/RtmpEorTs8/YourCity/post/df"      
 [14] "/tmp/RtmpEorTs8/YourCity/post/grids"   
 [15] "/tmp/RtmpEorTs8/YourCity/post/streets" 
 [16] "/tmp/RtmpEorTs8/YourCity/profiles"    
 [17] "/tmp/RtmpEorTs8/YourCity/veh"         
Scripts:
 [1] "est/BUS_01_input.R" 
 [2] "est/HGV_01_input.R" 
 [3] "est/LCV_01_input.R" 
 [4] "est/MC_01_input.R"  
 [5] "est/PC_01_input.R"  
 [6] "main.R"             
 [7] "post.R"            
 [8] "traffic.R" </code></pre>
<p>Please, read the examples in the documentation of each function and run the demo.</p>
<div id="examples-with-traffic-data" class="section level3">
<h3 class="hasAnchor">
<a href="#examples-with-traffic-data" class="anchor"></a>1) Examples with traffic data:</h3>
<p>age functions:</p>
<ul>
<li><a href="https://atmoschem.github.io/vein/reference/age_ldv.html">age_ldv</a></li>
<li><a href="https://atmoschem.github.io/vein/reference/age_hdv.html">age_hdv</a></li>
<li><a href="https://atmoschem.github.io/vein/reference/age_moto.html">age_moto</a></li>
<li><a href="https://atmoschem.github.io/vein/reference/my_age.html">my_age</a></li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/data">data</a></span>(<span class="st">"net"</span>)
PC_E25_<span class="dv">1400</span> &lt;-<span class="st"> </span><span class="kw"><a href="reference/age_ldv.html">age_ldv</a></span>(<span class="dt">x =</span> net<span class="op">$</span>ldv, <span class="dt">name =</span> <span class="st">"PC_E25_1400"</span>)
<span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(PC_E25_<span class="dv">1400</span>, <span class="dt">xlab =</span> <span class="st">"age of use"</span>)</code></pre></div>
<div class="figure">
<img src="https://atmoschem.github.io/vein/reference/age_ldv-1.png">
</div>
<p>If you want to know the vehicles per street and by age of use, just add the net. Age functions now returns ‘sf’ objects if the net argument is present.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">PC_E25_1400net &lt;-<span class="st"> </span><span class="kw"><a href="reference/age_ldv.html">age_ldv</a></span>(<span class="dt">x =</span> net<span class="op">$</span>ldv, <span class="dt">name =</span> <span class="st">"PC_E25_1400"</span>, <span class="dt">net =</span> net)
<span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(PC_E25_1400net)</code></pre></div>
<div class="figure">
<img src="https://atmoschem.github.io/vein/reference/age_ldv-2.png">
</div>
<ul>
<li><a href="https://atmoschem.github.io/vein/reference/temp_fact.html">temp_fact</a></li>
<li><a href="https://atmoschem.github.io/vein/reference/netspeed.html">netspeed</a></li>
</ul>
<p>temporal factors and netspeed</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/data">data</a></span>(<span class="st">"net"</span>)
<span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/data">data</a></span>(<span class="st">"pc_profile"</span>)
pc_week &lt;-<span class="st"> </span><span class="kw"><a href="reference/temp_fact.html">temp_fact</a></span>(net<span class="op">$</span>ldv<span class="op">+</span>net<span class="op">$</span>hdv, pc_profile)
dfspeed &lt;-<span class="st"> </span><span class="kw"><a href="reference/netspeed.html">netspeed</a></span>(pc_week, net<span class="op">$</span>ps, net<span class="op">$</span>ffs, net<span class="op">$</span>capacity, net<span class="op">$</span>lkm, <span class="dt">alpha =</span> <span class="fl">1.5</span>)
<span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(dfspeed)</code></pre></div>
<div class="figure">
<img src="https://atmoschem.github.io/vein/reference/netspeed-1.png">
</div>
<p>If you want ot check the speed at different hours by street, just add net:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dfspeednet &lt;-<span class="st"> </span><span class="kw"><a href="reference/netspeed.html">netspeed</a></span>(pc_week, net<span class="op">$</span>ps, net<span class="op">$</span>ffs, net<span class="op">$</span>capacity, net<span class="op">$</span>lkm,
                       <span class="dt">alpha =</span> <span class="fl">1.5</span>, <span class="dt">net =</span> net)
sp<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/sp/topics/spplot">spplot</a></span>(<span class="kw">as</span>(dfspeednet, <span class="st">"Spatial"</span>),
       <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"S1"</span>, <span class="st">"S9"</span>), <span class="dt">scales =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(<span class="dt">Draw =</span> T),
       <span class="dt">col.regions =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/rev">rev</a></span>(cptcity<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/cptcity/topics/cpt">cpt</a></span>()))</code></pre></div>
</div>
<div id="emission-factors" class="section level3">
<h3 class="hasAnchor">
<a href="#emission-factors" class="anchor"></a>2) Emission Factors</h3>
<ul>
<li><a href="https://atmoschem.github.io/vein/reference/ef_ldv_speed.html">ef_ldv_speed</a></li>
<li><a href="https://atmoschem.github.io/vein/reference/ef_hdv_speed.html">ef_hdv_speed</a></li>
<li><a href="https://atmoschem.github.io/vein/reference/ef_ldv_scaled.html">ef_ldv_scaled</a></li>
<li><a href="https://atmoschem.github.io/vein/reference/ef_hdv_scaled.html">ef_hdv_scaled</a></li>
<li><a href="https://atmoschem.github.io/vein/reference/EmissionFactors.html">EmissionFactors</a></li>
<li><a href="https://atmoschem.github.io/vein/reference/EmissionFactorsList.html">EmissionFactorsList</a></li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">V &lt;-<span class="st"> </span><span class="dv">0</span><span class="op">:</span><span class="dv">150</span>
ef1 &lt;-<span class="st"> </span><span class="kw"><a href="reference/ef_ldv_speed.html">ef_ldv_speed</a></span>(<span class="dt">v =</span> <span class="st">"PC"</span>,<span class="dt">t =</span> <span class="st">"4S"</span>, <span class="dt">cc =</span> <span class="st">"&lt;=1400"</span>, <span class="dt">f =</span> <span class="st">"G"</span>, <span class="dt">eu =</span> <span class="st">"PRE"</span>,
<span class="dt">p =</span> <span class="st">"CO"</span>)
efs &lt;-<span class="st"> </span><span class="kw"><a href="reference/EmissionFactors.html">EmissionFactors</a></span>(<span class="kw">ef1</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">150</span>))
<span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(<span class="kw"><a href="reference/Speed.html">Speed</a></span>(<span class="dv">1</span><span class="op">:</span><span class="dv">150</span>), efs, <span class="dt">xlab =</span> <span class="st">"speed[km/h]"</span>, <span class="dt">type =</span> <span class="st">"b"</span>, <span class="dt">pch =</span> <span class="dv">16</span>)</code></pre></div>
<div class="figure">
<img src="https://atmoschem.github.io/vein/reference/ef_ldv_speed-1.png">
</div>
</div>
<div id="estimation-of-emissions" class="section level3">
<h3 class="hasAnchor">
<a href="#estimation-of-emissions" class="anchor"></a>3) Estimation of emissions</h3>
<ul>
<li><a href="https://atmoschem.github.io/vein/reference/emis.html">emis</a></li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">euro &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/rep">rep</a></span>(<span class="st">"V"</span>, <span class="dv">5</span>), <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/rep">rep</a></span>(<span class="st">"IV"</span>, <span class="dv">5</span>), <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/rep">rep</a></span>(<span class="st">"III"</span>, <span class="dv">5</span>), <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/rep">rep</a></span>(<span class="st">"II"</span>, <span class="dv">5</span>),
          <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/rep">rep</a></span>(<span class="st">"I"</span>, <span class="dv">5</span>), <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/rep">rep</a></span>(<span class="st">"PRE"</span>, <span class="dv">15</span>))
lef &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/lapply">lapply</a></span>(<span class="dv">1</span><span class="op">:</span><span class="dv">40</span>, <span class="cf">function</span>(i) {
<span class="kw"><a href="reference/ef_ldv_speed.html">ef_ldv_speed</a></span>(<span class="dt">v =</span> <span class="st">"PC"</span>, <span class="dt">t =</span> <span class="st">"4S"</span>, <span class="dt">cc =</span> <span class="st">"&lt;=1400"</span>, <span class="dt">f =</span> <span class="st">"G"</span>,
          <span class="dt">eu =</span> euro[i], <span class="dt">p =</span> <span class="st">"CO"</span>, <span class="dt">show.equation =</span> <span class="ot">FALSE</span>) })
E_CO &lt;-<span class="st"> </span><span class="kw"><a href="reference/emis.html">emis</a></span>(<span class="dt">veh =</span> PC_E25_<span class="dv">1400</span>, <span class="dt">lkm =</span> net<span class="op">$</span>lkm, <span class="dt">ef =</span> lef, <span class="dt">speed =</span> dfspeed,
             <span class="dt">profile =</span> pc_profile)
<span class="co">#plot(E_CO, xlab = "Hours", ylab = "[g/h]")</span></code></pre></div>
</div>
<div id="post-emissions" class="section level3">
<h3 class="hasAnchor">
<a href="#post-emissions" class="anchor"></a>4) Post Emissions</h3>
<ul>
<li><a href="https://atmoschem.github.io/vein/reference/emis_post.html">emis_post</a></li>
<li>When the argument by = “veh” the emissions are aggregated by age and hour.</li>
<li>When the argument by = “streets_wide”, aggregated the emissions by street. In this cae, if you add the argument net with the respective streets, it returns an spatial net with the hourly emissions.</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">E_CO_DF &lt;-<span class="st"> </span><span class="kw"><a href="reference/emis_post.html">emis_post</a></span>(<span class="dt">arra =</span> E_CO,  <span class="dt">veh =</span> <span class="st">"PC"</span>, <span class="dt">size =</span> <span class="st">"&lt;1400"</span>, <span class="dt">fuel =</span> <span class="st">"G"</span>,
<span class="dt">pollutant =</span> <span class="st">"CO"</span>, <span class="dt">by =</span> <span class="st">"veh"</span>)
E_CO_STREETS &lt;-<span class="st"> </span><span class="kw"><a href="reference/emis_post.html">emis_post</a></span>(<span class="dt">arra =</span> E_CO, <span class="dt">pollutant =</span> <span class="st">"CO"</span>, <span class="dt">by =</span> <span class="st">"streets_wide"</span>)</code></pre></div>
<div id="grids" class="section level4">
<h4 class="hasAnchor">
<a href="#grids" class="anchor"></a>Grids</h4>
<ul>
<li>
<a href="https://atmoschem.github.io/vein/reference/make_grid.html">make_grid</a>.</li>
</ul>
<p>You can use this function in two ways</p>
<p>when spobj is “character”, it is a path to wrfinput file and then runs eixport::wrf_grid to create a grid based on a wrf_input file.</p>
<ol style="list-style-type: decimal">
<li>Create a grid using <code>make_grid</code>.The spobj is the spatial net. The size of the grid has the size of the net. You have to specify the grid spacing.</li>
<li>Create a grid using a path to wrfinput file instead a net. The grid will have the size of the wrf_input. You don’t have to specify the grid spacing.</li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/data">data</a></span>(net)
E_CO_STREETSnet &lt;-<span class="st"> </span><span class="kw"><a href="reference/emis_post.html">emis_post</a></span>(<span class="dt">arra =</span> E_CO, <span class="dt">pollutant =</span> <span class="st">"CO"</span>, <span class="dt">by =</span> <span class="st">"streets_wide"</span>,
                             <span class="dt">net =</span> net)
g &lt;-<span class="st"> </span><span class="kw"><a href="reference/make_grid.html">make_grid</a></span>(net, <span class="dv">1</span><span class="op">/</span><span class="fl">102.47</span><span class="op">/</span><span class="dv">2</span>) <span class="co">#500m in degrees</span>
<span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(g)
E_CO_g &lt;-<span class="st"> </span><span class="kw"><a href="reference/emis_grid.html">emis_grid</a></span>(<span class="dt">spobj =</span> E_CO_STREETSnet, <span class="dt">g =</span> g, <span class="dt">sr=</span> <span class="dv">31983</span>)
<span class="co">#sp::spplot(as(E_CO_g, "Spatial"),</span>
<span class="co">#       c("V1", "V9"), scales = list(Draw = T),</span>
<span class="co">#       col.regions = rev(cptcity::cpt()))</span></code></pre></div>
<div class="figure">
<img src="https://atmoschem.github.io/vein/reference/make_grid-1.png">
</div>
<p><strong>At this step, you can feed you grid with emissions from other sources!</strong></p>
</div>
</div>
<div id="creating-a-wrfchem-input-file-using-eixport" class="section level3">
<h3 class="hasAnchor">
<a href="#creating-a-wrfchem-input-file-using-eixport" class="anchor"></a>Creating a WRFChem Input file using <a href="https://atmoschem.github.io/eixport/">eixport</a>:</h3>
<ol style="list-style-type: decimal">
<li>Create a grid using <a href="https://atmoschem.github.io/vein/reference/make_grid.html">make_grid</a> and a wrfinput file</li>
<li>Run <a href="https://atmoschem.github.io/vein/reference/emis_grid.html">emis_grid</a> to grid your emissions.</li>
<li>Create a <a href="https://atmoschem.github.io/vein/reference/GriddedEmissionsArray.html">GriddedEmissionsArray</a>.</li>
<li>Create a wrfchem input file [eixport::wrf_create](<a href="https://atmoschem.github.io/eixport/reference/wrf_create.html" class="uri">https://atmoschem.github.io/eixport/reference/wrf_create.html</a>.</li>
<li>Put the <a href="https://atmoschem.github.io/vein/reference/GriddedEmissionsArray.html">GriddedEmissionsArray</a> into the wrf chem input file using <a href="https://atmoschem.github.io/eixport/reference/wrf_put.html">eixport::wrf_put</a>.</li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">eixport<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/eixport/topics/wrf_create">wrf_create</a></span>(<span class="dt">wrfinput_dir =</span> <span class="st">"PathToWrfInput"</span>, <span class="dt">wrfchemi_dir =</span> <span class="st">"OutputPathWrfChemInput"</span>)
gwrf &lt;-<span class="st"> </span>eixport<span class="op">::</span><span class="kw">wrf_grd</span>(<span class="st">"PathToWrfInput"</span>)
E_CO_gwrf &lt;-<span class="st"> </span><span class="kw"><a href="reference/emis_grid.html">emis_grid</a></span>(<span class="dt">spobj =</span> E_CO_STREETSnet, <span class="dt">g =</span> gwrf)
gr &lt;-<span class="st"> </span><span class="kw"><a href="reference/GriddedEmissionsArray.html">GriddedEmissionsArray</a></span>(E_CO_gwrf, <span class="dt">rows =</span> <span class="dv">19</span>, <span class="dt">cols =</span> <span class="dv">23</span>, <span class="dt">times =</span> <span class="dv">168</span>, T)
eixport<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/eixport/topics/wrf_put">wrf_put</a></span>(<span class="dt">file =</span> <span class="st">"Path/To/WRFChemInputFile, name = "</span>E_CO<span class="st">", POL = gr)</span></code></pre></div>
</div>
<div id="creating-a-wrfchem-input-file-using-as4wrf" class="section level3">
<h3 class="hasAnchor">
<a href="#creating-a-wrfchem-input-file-using-as4wrf" class="anchor"></a>Creating a WRFChem Input file using AS4WRF</h3>
<ol style="list-style-type: decimal">
<li>Create a grid using <a href="https://atmoschem.github.io/vein/reference/make_grid.html">make_grid</a> and your net.</li>
<li>Run <a href="https://atmoschem.github.io/vein/reference/emis_grid.html">emis_grid</a> to grid your emissions.</li>
<li>Run <a href="https://atmoschem.github.io/vein/reference/emis_wrf.html">emis_wrf</a> to create a data.frame the specifications for AS4WRF.ncl.</li>
<li>Export the output of <a href="https://atmoschem.github.io/vein/reference/emis_wrf.html">emis_wrf</a> to a text file without header. Recall that AS4WRF requires all the lumped species.</li>
<li>Contact the developer of AS4WRF Angel Vara <a href="mailto:alvv1986@gmail.com">alvv1986@gmail.com</a> to get a copy and run AS4WRF.ncl.</li>
</ol>
<p>Thanks and enjoy VEIN!</p>
</div>
</div>
<div id="citation" class="section level2">
<h2 class="hasAnchor">
<a href="#citation" class="anchor"></a>Citation</h2>
<p>If you use VEIN, please, cite it (<a href="https://www.geosci-model-dev.net/11/2209/2018/gmd-11-2209-2018.bib">BIBTEX</a>, <a href="https://www.geosci-model-dev.net/11/2209/2018/gmd-11-2209-2018.ris">ENDNOTE</a>):</p>
<p>Ibarra-Espinosa, S., Ynoue, R., O’Sullivan, S., Pebesma, E., Andrade, M. D. F., and Osses, M.: VEIN v0.2.2: an R package for bottom-up vehicular emissions inventories, Geosci. Model Dev., 11, 2209-2229, <a href="https://doi.org/10.5194/gmd-11-2209-2018" class="uri">https://doi.org/10.5194/gmd-11-2209-2018</a>, 2018.</p>
<pre><code>@article{gmd-11-2209-2018,
author = {Ibarra-Espinosa, S. and Ynoue, R. and O'Sullivan, S. and Pebesma, E. and Andrade, M. D. F. and Osses, M.},
title = {VEIN v0.2.2: an R package for bottom--up vehicular emissions inventories},
journal = {Geoscientific Model Development},
volume = {11},
year = {2018},
number = {6},
pages = {2209--2229},
url = {https://www.geosci-model-dev.net/11/2209/2018/},
doi = {10.5194/gmd-11-2209-2018}
}</code></pre>
</div>
<div id="communications-doubts-etc" class="section level2">
<h2 class="hasAnchor">
<a href="#communications-doubts-etc" class="anchor"></a>Communications, doubts etc</h2>
<ul>
<li>Drop me an email <a href="mailto:sergio.ibarra@usp.br">sergio.ibarra@usp.br</a>
</li>
<li>You can ask on <a href="https://earthscience.stackexchange.com/">Eart Science Stackoverflow</a>,.</li>
<li>Check the project on <a href="https://www.researchgate.net/project/VEIN-An-R-package-for-vehicular-emissions-inventories">ResearchGate</a>.</li>
<li>Check the group on GoogleGroups <a href="https://groups.google.com/d/forum/veinmodel">Group</a>.</li>
</ul>
</div>
<div id="issues" class="section level2">
<h2 class="hasAnchor">
<a href="#issues" class="anchor"></a>Issues</h2>
<p>If you encounter any issues while using VEIN, please submit your issues to: <a href="https://github.com/atmoschem/vein/issues/" class="uri">https://github.com/atmoschem/vein/issues/</a></p>
<p>If you have any suggestions just let me know to <a href="mailto:sergio.ibarra@usp.br">sergio.ibarra@usp.br</a>.</p>
<div id="contributing" class="section level3">
<h3 class="hasAnchor">
<a href="#contributing" class="anchor"></a>Contributing</h3>
<p>Please, read <a href="https://github.com/atmoschem/vein/blob/master/CONTRIBUTING.md">this</a> guide. Contributions of all sorts are welcome, issues and pull requests are the preferred ways of sharing them. When contributing pull requests, please follow the <a href="https://google.github.io/styleguide/Rguide.xml">Google’s R Style Guide</a>. This project is released with a <a href="https://github.com/atmoschem/vein/blob/master/CODE_OF_CONDUCT.md">Contributor Code of Conduct</a>. By participating in this project you agree to abide by its terms.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <div class="links">
<h2>Links</h2>
<ul class="list-unstyled">
<li>Download from CRAN at <br><a href="https://cloud.r-project.org/package=vein">https://​cloud.r-project.org/​package=vein</a>
</li>
<li>Report a bug at <br><a href="https://github.com/atmoschem/vein/issues/">https://​github.com/​atmoschem/​vein/​issues/​</a>
</li>
</ul>
</div>
<div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li>
<a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a>
</li>
</ul>
</div>
<div class="citation">
<h2>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html">Citing vein</a></li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Sergio Ibarra-Espinosa <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0002-3162-1905" target="orcid.widget"><img src="https://members.orcid.org/sites/default/files/vector_iD_icon.svg" class="orcid" alt="ORCID" height="16"></a> </li>
<li><a href="authors.html">All authors...</a></li>
</ul>
</div>

      <div class="dev-status">
<h2>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://travis-ci.org/atmoschem/vein"><img src="https://travis-ci.org/atmoschem/vein.svg?branch=master" alt="Travis-CI Build Status"></a></li>
<li><a href="https://ci.appveyor.com/project/ibarraespinosa/vein"><img src="https://ci.appveyor.com/api/projects/status/github/ibarraespinosa/vein?branch=master&amp;svg=true" alt="AppVeyor Build Status"></a></li>
<li><a href="http://cran.rstudio.com/web/packages/vein/index.html"><img src="http://cranlogs.r-pkg.org/badges/vein"></a></li>
<li><a href="https://zenodo.org/badge/latestdoi/88201850"><img src="https://zenodo.org/badge/88201850.svg" alt="DOI"></a></li>
<li><a href="https://codecov.io/github/atmoschem/vein?branch=master"><img src="https://img.shields.io/codecov/c/github/atmoschem/vein/master.svg" alt="Coverage Status"></a></li>
<li><a href="http://cran.r-project.org/web/packages/vein"><img src="http://www.r-pkg.org/badges/version/vein" alt="CRAN_Status_Badge"></a></li>
<li><a href="http://cran.r-project.org/package=vein"><img src="http://cranlogs.r-pkg.org/badges/grand-total/vein?color=orange" alt="CRAN Downloads"></a></li>
<li><a href="https://www.tidyverse.org/lifecycle/#maturing"><img src="https://img.shields.io/badge/lifecycle-maturing-blue.svg" alt="Package Status"></a></li>
<li><a href="https://github.com/atmoschem/vein"><img src="https://img.shields.io/github/stars/atmoschem/vein.svg?style=social&amp;label=Github" alt="Github Stars"></a></li>
</ul>
</div>
</div>

</div>


      <footer><div class="copyright">
  <p>Developed by Sergio Ibarra-Espinosa.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
