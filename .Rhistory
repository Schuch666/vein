dim(apply(X = arra[, 1,,], MARGIN = c(1,2), FUN = sum, na.rm = TRUE))
dim(apply(X = arra[, 1,,], MARGIN = c(1,4), FUN = sum, na.rm = TRUE))
class(arra[, 1, , ])
dim(arra[, 1, , ])
dim(apply(X = arra[, 1,,], MARGIN = c(2,3), FUN = sum, na.rm = TRUE))
dim(apply(X = arra[, 1,,], MARGIN = c(1,3), FUN = sum, na.rm = TRUE))
dim(apply(X = arra[, 1,,], MARGIN = c(1,2), FUN = sum, na.rm = TRUE))
dim(apply(X = arra[, ,,], MARGIN = c(1,2), FUN = sum, na.rm = TRUE))
dim(arra)
rowSums(arra[ , 2:5, , ])
dim(rowSums(arra[ , 2:5, , ]))
rowSums(arra[ , 2:5, , ])
length(arra[ , 2:5, , ])
devtools::load_all(".")
library(vein)
library(vein)
#' data(net)
#' data(pc_profile)
#' pc_week <- temp_fact(net$ldv+net$hdv, pc_profile[, 1])
#' df <- netspeed(pc_week, net$ps, net$ffs, net$capacity, net$lkm, alpha = 1)
#' ef <- ef_wear(wear = "tyre", type = "PC", pol = "PM10", speed = df)
#' emi <- emis_wear(veh = age_ldv(net$ldv, name = "VEH"),
#'                  lkm = net$lkm, ef = ef, speed = df,
#'                  profile = pc_profile[, 1])
#' emi
#' }
emis_wear <- function (veh,
lkm,
ef,
what = "tyre",
speed,
agemax = ncol(veh),
profile,
hour = nrow(profile),
day = ncol(profile)) {
if(units(lkm)$numerator == "m" ){
stop("Units of lkm is 'm'")
}
veh <- as.data.frame(veh)
lkm <- as.numeric(lkm)
if(is.data.frame(profile)){
profile <- profile
} else if(is.matrix(ef)){
profile <- profile
} else if(is.vector(profile)){
profile <- matrix(as.numeric(profile), ncol = 1)
}
if(ncol(ef)/24 != day){
stop("Number of days of ef and profile must be the same")
}
if(!missing(profile) & is.data.frame(profile)){
profile <- profile
} else if(!missing(profile) & is.matrix(profile)){
profile <- profile
} else if(!missing(profile) & is.vector(profile)){
profile <- matrix(profile, ncol = 1)
}
lef <- lapply(1:day, function(i){
as.list(ef[, (24*(i-1) + 1):(24*i)])
})
# lapply(ef, as.list)
if (what == "tyre"){
d <-  simplify2array(
lapply(1:day,function(j){
simplify2array(
lapply(1:hour,function(i){
simplify2array(
lapply(1:agemax, function(k){
ifelse(
speed[,i] < 40,
veh[, k]*profile[i,j]*lkm*lef[[j]][[i]]*1.67,
ifelse(
speed[,i] >= 40 & speed[,i] <= 95,
veh[, k]*profile[i,j]*lkm*lef[[j]][[i]]*(-0.0270*speed[, i] + 2.75),
veh[, k]*profile[i,j]*lkm*lef[[j]][[i]]*0.185
)) })) })) }))
} else if(what){
d <-  simplify2array(
lapply(1:day,function(j){
simplify2array(
lapply(1:hour,function(i){
simplify2array(
lapply(1:agemax, function(k){
ifelse(
speed[,i] < 40,
veh[, k]*profile[i,j]*lkm*lef[[j]][[i]]*1.39,
ifelse(
speed[,i] >= 40 & speed[,i] < 80,
veh[, k]*profile[i,j]*lkm*lef[[j]][[i]]*(-0.00974*speed[, i] + 1.78),
ifelse(
speed[,i] == 80,
veh[, k]*profile[i,j]*lkm*lef[[j]][[i]],
ifelse(
speed[,i] > 80 & speed[,i] <= 90,
veh[, k]*profile[i,j]*lkm*lef[[j]][[i]]*(-0.00974*speed[, i] + 1.78),
veh[, k]*profile[i,j]*lkm*lef[[j]][[i]]*0.902
)))) })) })) }))
} else {
d <-  simplify2array(
lapply(1:day,function(j){
simplify2array(
lapply(1:hour,function(i){
simplify2array(
lapply(1:agemax, function(k){
veh[, k]*profile[i,j]*lkm*lef[[j]][[i]]
})) })) }))
}
return(EmissionsArray(d))
}
library(devtools)
library(testthat)
use_testthat()
use_test("emis_wear")
data(net)
data(pc_profile)
pc_week <- temp_fact(net$ldv+net$hdv, pc_profile[, 1])
df <- netspeed(pc_week, net$ps, net$ffs, net$capacity, net$lkm, alpha = 1)
ef <- ef_wear(wear = "tyre", type = "PC", pol = "PM10", speed = df)
emi <- emis_wear(veh = age_ldv(net$ldv, name = "VEH"),
lkm = net$lkm, ef = ef, speed = df,
profile = pc_profile[, 1])
devtools::load_all(".")
library(vein)
library(vein)
rm(emis_wear())
rm(emis_wear)
data(net)
data(pc_profile)
pc_week <- temp_fact(net$ldv+net$hdv, pc_profile[, 1])
df <- netspeed(pc_week, net$ps, net$ffs, net$capacity, net$lkm, alpha = 1)
ef <- ef_wear(wear = "tyre", type = "PC", pol = "PM10", speed = df)
emi <- emis_wear(veh = age_ldv(net$ldv, name = "VEH"),
lkm = net$lkm, ef = ef, speed = df,
profile = pc_profile[, 1])
emi
emi[1]
test_that("emis_wear works", {
expect_equal(emis_wear(veh = age_ldv(net$ldv, name = "VEH"),
lkm = net$lkm, ef = ef, speed = df,
profile = pc_profile[, 1])[1],
0.03503776)
})
emis_wear(veh = age_ldv(net$ldv, name = "VEH"),
lkm = net$lkm, ef = ef, speed = df,
what = "break",
profile = pc_profile[, 1])[1]
emis_wear(veh = age_ldv(net$ldv, name = "VEH"),
lkm = net$lkm, ef = ef, speed = df,
what = "break",
profile = pc_profile[, 1])[1]
emis_wear(what = "break", veh = age_ldv(net$ldv, name = "VEH"),
lkm = net$lkm, ef = ef, speed = df,
profile = pc_profile[, 1])[1]
emis_wear(what = "tyre", veh = age_ldv(net$ldv, name = "VEH"),
lkm = net$lkm, ef = ef, speed = df,
profile = pc_profile[, 1])[1]
devtools::load_all(".")
library(vein)
library(vein)
emis_wear(what = "tyre", veh = age_ldv(net$ldv, name = "VEH"),
lkm = net$lkm, ef = ef, speed = df,
profile = pc_profile[, 1])[1]
emis_wear(what = "break", veh = age_ldv(net$ldv, name = "VEH"),
lkm = net$lkm, ef = ef, speed = df,
profile = pc_profile[, 1])[1]
emis_wear(what = "road", veh = age_ldv(net$ldv, name = "VEH"),
lkm = net$lkm, ef = ef, speed = df,
profile = pc_profile[, 1])[1]
test_that("emis_wear works", {
expect_equal(emis_wear(veh = age_ldv(net$ldv, name = "VEH"),
lkm = net$lkm, ef = ef, speed = df,
profile = pc_profile[, 1])[1],
0.03503776)
})
test_that("emis_wear works", {
expect_equal(emis_wear(veh = age_ldv(net$ldv, name = "VEH"),
lkm = net$lkm, ef = ef, speed = df,
what = "break",
profile = pc_profile[, 1])[1],
0.03702493)
})
test_that("emis_wear works", {
expect_equal(emis_wear(veh = age_ldv(net$ldv, name = "VEH"),
lkm = net$lkm, ef = ef, speed = df,
what = "road",
profile = pc_profile[, 1])[1],
0.03094737)
})
pkgdown:::build_site_rstudio()
pkgdown:::build_site_rstudio()
pkgdown:::build_site_rstudio()
devtools::load_all(".")
system("locate sysdata.R")
ldv <- read.csv("~/MEGA/PhDgrive/Literatura/COPERT/ef_pc_v2.csv", h=T)
ldv$EURO <- gsub(pattern = " ", replacement="", x = ldv$EURO)
hdv <- read.csv("~/MEGA/PhDgrive/Literatura/COPERT/ef_hdv.csv", h=T)
hdv$EURO <- gsub(pattern = " ", replacement="", x = hdv$EURO)
ev <- read.csv("~/MEGA/PhDgrive/Literatura/COPERT/ev_t2.csv", h=T)
bcom <- read.csv("~/MEGA/PhDgrive/Literatura/COPERT/bcom.csv", h=T)
cold <- read.csv("~/MEGA/PhDgrive/Literatura/COPERT/cold.csv", h=T)
iag <- read.csv("~/MEGA/PhDgrive/Literatura/COPERT/iag4.csv", h=T) #sergio
nox <- read.csv("~/MEGA/PhDgrive/Literatura/COPERT/nox.csv", h=T)
nitro <- read.csv("~/MEGA/PhDgrive/Literatura/COPERT/nitro.csv", h=T)
nmhc <- read.csv("~/MEGA/PhDgrive/Literatura/COPERT/nmhc.csv", h=T)
sysdata <- list(ldv, hdv, ev, bcom, cold, iag, nox, nitro, nmhc)
save(sysdata, file="~/Documentos/vein/R/sysdata.rda", compress = "xz")
devtools::load_all(".")
library(vein)
library(vein)
ef_ldv_speed("PC", "4S", "<=1400", "G", "PRE", "NMHC")
ef_ldv_speed("PC", "4S", "<=1400", "G", "PRE", "NMHC")(1:100)
ef_ldv_speed("PC", "4S", "<=1400", "G", "PRE", "NMHC")(1)
ef_ldv_speed("PC", "4S", "<=1400", "G", "PRE", "CO")(30)
ef_ldv_speed("PC", "4S", "<=1400", "G", "PRE", "NOx")(30)
ef_ldv_speed("PC", "4S", "<=1400", "G", "PRE", "HC")(30)
ef_ldv_speed("PC", "4S", "<=1400", "G", "PRE", "FC")(30)
ef_ldv_speed("PC", "4S", "<=1400", "G", "PRE", "PM")(30)
ef_ldv_speed("PC", "4S", "<=1400", "G", "PRE", "NMHC")(30)
ef_ldv_speed("PC", "4S", "<=1400", "G", "PRE", "CH4")(30)
ef_ldv_speed("PC", "4S", "<=1400", "G", "PRE", "CO2")(30)
ef_ldv_speed("PC", "4S", "<=1400", "G", "PRE", "SO2", sulphur = 50)(30)
ef_ldv_speed("PC", "4S", "<=1400", "G", "PRE", "CH4")(30)
ldv <- read.csv("~/MEGA/PhDgrive/Literatura/COPERT/ef_pc_may2018.csv", h=T)
ldv$EURO <- gsub(pattern = " ", replacement="", x = ldv$EURO)
hdv <- read.csv("~/MEGA/PhDgrive/Literatura/COPERT/ef_hdv.csv", h=T)
hdv$EURO <- gsub(pattern = " ", replacement="", x = hdv$EURO)
ev <- read.csv("~/MEGA/PhDgrive/Literatura/COPERT/ev_t2.csv", h=T)
bcom <- read.csv("~/MEGA/PhDgrive/Literatura/COPERT/bcom.csv", h=T)
cold <- read.csv("~/MEGA/PhDgrive/Literatura/COPERT/cold.csv", h=T)
iag <- read.csv("~/MEGA/PhDgrive/Literatura/COPERT/iag4.csv", h=T) #sergio
nox <- read.csv("~/MEGA/PhDgrive/Literatura/COPERT/nox.csv", h=T)
nitro <- read.csv("~/MEGA/PhDgrive/Literatura/COPERT/nitro.csv", h=T)
nmhc <- read.csv("~/MEGA/PhDgrive/Literatura/COPERT/nmhc.csv", h=T)
sysdata <- list(ldv, hdv, ev, bcom, cold, iag, nox, nitro, nmhc)
save(sysdata, file="~/Documentos/vein/R/sysdata.rda", compress = "xz")
devtools::load_all(".")
library(vein)
library(vein)
ef_ldv_speed("PC", "4S", "<=1400", "G", "PRE", "CO")(30)
ef_ldv_speed("PC", "4S", "<=1400", "G", "PRE", "NOx")(30)
ef_ldv_speed("PC", "4S", "<=1400", "G", "PRE", "HC")(30)
ef_ldv_speed("PC", "4S", "<=1400", "G", "PRE", "FC")(30)
ef_ldv_speed("PC", "4S", "<=1400", "G", "PRE", "PM")(30)
ef_ldv_speed("PC", "4S", "<=1400", "G", "PRE", "NMHC")(30)
ef_ldv_speed("PC", "4S", "<=1400", "G", "PRE", "CH4")(30)
ef_ldv_speed("PC", "4S", "<=1400", "G", "PRE", "HC")(30)
ef_ldv_speed("PC", "4S", "<=1400", "G", "PRE", "NMHC")(30)
ef_ldv_speed("PC", "4S", "<=1400", "G", "PRE", "CH4")(30)
ef_ldv_speed("PC", "4S", "<=1400", "G", "PRE", "FC")(30)
ef_ldv_speed("PC", "4S", "<=1400", "G", "PRE", "PM")(30)
devtools::load_all(".")
library(vein)
library(vein)
pol <- c("CO", "NOx", "HC", "NMHC", "CH4", "FC", "PM", "CO2", "SO2", "Pb")
sapply(1:length(pol), function(i){
ef_ldv_speed("PC", "4S", "<=1400", "G", "PRE", pol[i])(30)
})
devtools::load_all(".")
library(vein)
ev <- read.csv("~/MEGA/PhDgrive/Literatura/COPERT/ev_t2.csv", h=T)
ldv <- read.csv("~/MEGA/PhDgrive/Literatura/COPERT/ef_pc_may2018.csv", h=T)
ldv$EURO <- gsub(pattern = " ", replacement="", x = ldv$EURO)
hdv <- read.csv("~/MEGA/PhDgrive/Literatura/COPERT/ef_hdv.csv", h=T)
hdv$EURO <- gsub(pattern = " ", replacement="", x = hdv$EURO)
ev <- read.csv("~/MEGA/PhDgrive/Literatura/COPERT/ev_t2.csv", h=T)
bcom <- read.csv("~/MEGA/PhDgrive/Literatura/COPERT/bcom.csv", h=T)
cold <- read.csv("~/MEGA/PhDgrive/Literatura/COPERT/cold.csv", h=T)
iag <- read.csv("~/MEGA/PhDgrive/Literatura/COPERT/iag4.csv", h=T) #sergio
nox <- read.csv("~/MEGA/PhDgrive/Literatura/COPERT/nox.csv", h=T)
nitro <- read.csv("~/MEGA/PhDgrive/Literatura/COPERT/nitro.csv", h=T)
nmhc <- read.csv("~/MEGA/PhDgrive/Literatura/COPERT/nmhc.csv", h=T)
sysdata <- list(ldv, hdv, ev, bcom, cold, iag, nox, nitro, nmhc)
save(sysdata, file="~/Documentos/vein/R/sysdata.rda", compress = "xz")
devtools::load_all(".")
library(vein)
library(vein)
pol <- c("CO", "NOx", "HC", "NMHC", "CH4", "FC", "PM", "CO2", "SO2", "Pb")
sapply(1:length(pol), function(i){
ef_ldv_speed("PC", "4S", "<=1400", "G", "PRE", pol[i])(30)
})
ldv <- read.csv("~/MEGA/PhDgrive/Literatura/COPERT/ef_pc_may2018.csv", h=T)
ldv$EURO <- gsub(pattern = " ", replacement="", x = ldv$EURO)
hdv <- read.csv("~/MEGA/PhDgrive/Literatura/COPERT/ef_hdv.csv", h=T)
hdv$EURO <- gsub(pattern = " ", replacement="", x = hdv$EURO)
ev <- read.csv("~/MEGA/PhDgrive/Literatura/COPERT/ev_t2.csv", h=T)
bcom <- read.csv("~/MEGA/PhDgrive/Literatura/COPERT/bcom.csv", h=T)
cold <- read.csv("~/MEGA/PhDgrive/Literatura/COPERT/cold.csv", h=T)
iag <- read.csv("~/MEGA/PhDgrive/Literatura/COPERT/iag4.csv", h=T) #sergio
nox <- read.csv("~/MEGA/PhDgrive/Literatura/COPERT/nox.csv", h=T)
nitro <- read.csv("~/MEGA/PhDgrive/Literatura/COPERT/nitro.csv", h=T)
nmhc <- read.csv("~/MEGA/PhDgrive/Literatura/COPERT/nmhc.csv", h=T)
sysdata <- list(ldv, hdv, ev, bcom, cold, iag, nox, nitro, nmhc)
save(sysdata, file="~/Documentos/vein/R/sysdata.rda", compress = "xz")
devtools::load_all(".")
library(vein)
library(vein)
pol <- c("CO", "NOx", "HC", "NMHC", "CH4", "FC", "PM", "CO2", "SO2", "Pb")
sapply(1:length(pol), function(i){
ef_ldv_speed("PC", "4S", "<=1400", "G", "PRE", pol[i])(30)
})
pol <- c("CO", "NOx", "HC", "NMHC", "CH4", "FC", "PM", "CO2")
sapply(1:length(pol), function(i){
ef_ldv_speed("PC", "4S", "<=1400", "G", "PRE", pol[i])(30)
})
pol <- c("Pb", "SO2")
sapply(1:length(pol), function(i){
ef_ldv_speed("PC", "4S", "<=1400", "G", "PRE", pol[i], x = 10)(30)
})
devtools::load_all(".")
library(vein)
library(vein)
pol <- c("Pb", "SO2")
sapply(1:length(pol), function(i){
ef_ldv_speed("PC", "4S", "<=1400", "G", "PRE", pol[i], x = 10)(30)
})
# Quick view
pol <- c("CO", "NOx", "HC", "NMHC", "CH4", "FC", "PM", "CO2")
sapply(1:length(pol), function(i){
ef_ldv_speed("PC", "4S", "<=1400", "G", "PRE", pol[i])(30)
})
pol <- c("Pb", "SO2")
sapply(1:length(pol), function(i){
ef_ldv_speed("PC", "4S", "<=1400", "G", "PRE", pol[i], x = 10)(30)
})
ldv <- read.csv("~/MEGA/PhDgrive/Literatura/COPERT/ef_pc_may2018.csv", h=T)
ldv$EURO <- gsub(pattern = " ", replacement="", x = ldv$EURO)
hdv <- read.csv("~/MEGA/PhDgrive/Literatura/COPERT/ef_hdv.csv", h=T)
hdv$EURO <- gsub(pattern = " ", replacement="", x = hdv$EURO)
ev <- read.csv("~/MEGA/PhDgrive/Literatura/COPERT/ev_t2.csv", h=T)
bcom <- read.csv("~/MEGA/PhDgrive/Literatura/COPERT/bcom.csv", h=T)
cold <- read.csv("~/MEGA/PhDgrive/Literatura/COPERT/cold.csv", h=T)
iag <- read.csv("~/MEGA/PhDgrive/Literatura/COPERT/iag4.csv", h=T) #sergio
nox <- read.csv("~/MEGA/PhDgrive/Literatura/COPERT/nox.csv", h=T)
nitro <- read.csv("~/MEGA/PhDgrive/Literatura/COPERT/nitro.csv", h=T)
nmhc <- read.csv("~/MEGA/PhDgrive/Literatura/COPERT/nmhc.csv", h=T)
sysdata <- list(ldv, hdv, ev, bcom, cold, iag, nox, nitro, nmhc)
save(sysdata, file="~/Documentos/vein/R/sysdata.rda", compress = "xz")
devtools::load_all(".")
library(vein)
pol <- c("CO", "NOx", "HC", "NMHC", "CH4", "FC", "PM", "CO2", "Pb", "SO2")
sapply(1:length(pol), function(i){
ef_ldv_speed("PC", "4S", "<=1400", "G", "PRE", pol[i], x = 10)(30)
})
ef1 <- ef_ldv_speed(v = "Motorcycle",t = "4S", cc = "<=250", f = "G",
eu = "PRE", p = "CO")
eu = "PRE", p = "CO",T)
ef1 <- ef_ldv_speed(v = "Motorcycle",t = "4S", cc = "<=250", f = "G",
eu = "PRE", p = "CO",T)
efs <- EmissionFactors(ef1(1:150))
ef1 <- ef_ldv_speed(v = "Motorcycle",t = "4S", cc = "<=250", f = "G",
eu = "PRE", p = "CO",T)
eu = "PRE", p = "CO",show.equation = T)
ef1 <- ef_ldv_speed(v = "Motorcycle",t = "4S", cc = "<=250", f = "G",
eu = "PRE", p = "CO",show.equation = T)
devtools::load_all(".")
library(vein)
library(vein)
library(vein)
pol <- c("CO", "NOx", "HC", "NMHC", "CH4", "FC", "PM", "CO2", "Pb", "SO2")
sapply(1:length(pol), function(i){
ef_ldv_speed("PC", "4S", "<=1400", "G", "PRE", pol[i], x = 10)(30)
})
f <- sapply(1:length(pol), function(i){
ef_ldv_speed("PC", "4S", "<=1400", "G", "PRE", pol[i], x = 10)(30)
})
class(f)
test_that("ef_ldv_speed works", {
expect_equal(sapply(1:length(pol), function(i){
ef_ldv_speed("PC", "4S", "<=1400", "G", "PRE", pol[i], x = 10)(30)}),
c(3.297007e+01, 1.722000e+00, 2.873231e+00, 2.742231e+00, 1.310000e-01,
7.916123e+01, 0.000000e+00, 2.519344e+02, 5.937092e-04, 1.583225e-03))
})
library(devtools)
library(testthat)
test_that("ef_ldv_speed works", {
expect_equal(sapply(1:length(pol), function(i){
ef_ldv_speed("PC", "4S", "<=1400", "G", "PRE", pol[i], x = 10)(30)}),
c(3.297007e+01, 1.722000e+00, 2.873231e+00, 2.742231e+00, 1.310000e-01,
7.916123e+01, 0.000000e+00, 2.519344e+02, 5.937092e-04, 1.583225e-03))
})
test_that("ef_ldv_speed works", {
expect_equal(sapply(1:length(pol), function(i){
ef_ldv_speed("PC", "4S", "<=1400", "G", "PRE", pol[i], x = 10)(30)}),
c(3.297007e+01 + 4.57e-06,
1.722000e+00,
2.873231e+00 + 2.27e-08,
2.742231e+00 + 2.27e-08,
1.310000e-01,
7.916123e+01 + 2.66e-06,
0.000000e+00,
2.519344e+02 + 2.77e-05,
5.937092e-04,
1.583225e-03))
})
devtools::load_all(".")
library(vein)
library(vein)
devtools::load_all(".")
library(vein)
library(vein)
data(net)
data(pc_profile)
pc_week <- temp_fact(net$ldv[1:10] + net$hdv[1:10], pc_profile[, 1])
df <- netspeed(pc_week, net$ps[1:10], net$ffs[1:10],
net$capacity[1:10], net$lkm[1:10], alpha = 1)
ef <- ef_wear(wear = "tyre", type = "PC", pol = "PM10", speed = df)
emi <- emis_wear(veh = age_ldv(net$ldv[1:10], name = "VEH"),
lkm = net$lkm[1:10], ef = ef, speed = df,
profile = pc_profile[, 1])
emi
use_test("emis_wear")
use_test("emis")
?emis
emis(veh = age_ldv(net$ldv[1], name = "VEH"),
lkm = net$lkm[1], ef = lef, speed = df,
profile = pc_profile[1])
euro <- as.character(fe2015[fe2015$Pollutant=="CO", "Euro_LDV"])
data(fe2015)
euro <- as.character(fe2015[fe2015$Pollutant=="CO", "Euro_LDV"])
euro
lef <- EmissionFactorsList(fe2015[fe2015$Pollutant=="CO", "PC_G"])
pc_week <- temp_fact(net$ldv[1] + net$hdv[1], pc_profile[, 1])
df <- netspeed(pc_week, net$ps[1], net$ffs[1],
net$capacity[1], net$lkm[1], alpha = 1)
ef <- ef_wear(wear = "tyre", type = "PC", pol = "PM10", speed = df)
emis(veh = age_ldv(net$ldv[1], name = "VEH"),
lkm = net$lkm[1], ef = lef, speed = df,
profile = pc_profile[1])
emis(veh = age_ldv(net$ldv[1], name = "VEH"),
lkm = net$lkm[1], ef = lef, speed = df,
profile = pc_profile[1])[1]
expect_equal(emis(veh = age_ldv(net$ldv[1], name = "VEH"),
lkm = net$lkm[1], ef = lef, speed = df,
profile = pc_profile[1])[1], 0.5930209)
expect_equal(emis(veh = age_ldv(net$ldv[1], name = "VEH"),
lkm = net$lkm[1], ef = lef, speed = df,
profile = pc_profile[1])[1],
0.5930209 + 4.83e-08)
devtools::load_all(".")
library(vein)
pol <- c("CO", "NOx", "HC", "NMHC", "CH4", "FC", "PM", "CO2", "Pb", "SO2")
f <- sapply(1:length(pol), function(i){
ef_hdv_speed(v = "Trucks",t = "RT", g = "<=7.5", e = "II", gr = 0,
l = 0.5, p = pol[i], x = 10)(30)
})
f <- sapply(1:length(pol), function(i){
print(pol[i])
ef_hdv_speed(v = "Trucks",t = "RT", g = "<=7.5", e = "II", gr = 0,
l = 0.5, p = pol[i], x = 10)(30)
})
pol <- c("CO", "NOx", "HC", "NMHC", "CH4", "FC", "PM", "CO2", "SO2")
f <- sapply(1:length(pol), function(i){
print(pol[i])
ef_hdv_speed(v = "Trucks",t = "RT", g = "<=7.5", e = "II", gr = 0,
l = 0.5, p = pol[i], x = 10)(30)
})
f
hdv <- read.csv("~/MEGA/PhDgrive/Literatura/COPERT/ef_hdv.csv", h=T)
hdv$EURO <- gsub(pattern = " ", replacement="", x = hdv$EURO)
unique(hdv$POLLUTANT)
sysdata
ef_hdv <- sysdata[[2]]
v = "Trucks"
t = "RT"
g = "<=7.5"
e = "II"
gr = 0
l = 0.5
p = "Pb"
df <- ef_hdv[ef_hdv$VEH == v &
ef_hdv$TYPE == t &
ef_hdv$GW == g &
ef_hdv$EURO == eu &
ef_hdv$GRA == gr &
ef_hdv$LOAD == l &
ef_hdv$POLLUTANT == p, ]
eu = "II"
df <- ef_hdv[ef_hdv$VEH == v &
ef_hdv$TYPE == t &
ef_hdv$GW == g &
ef_hdv$EURO == eu &
ef_hdv$GRA == gr &
ef_hdv$LOAD == l &
ef_hdv$POLLUTANT == p, ]
df
v
t
g
eu
gr
l
p
ef_hdv <- sysdata[[2]]
ef_hdv[ef_hdv$POLLUTANT == "Pb", ]
unique(ef_hdv$POLLUTANT)
ldv <- read.csv("~/MEGA/PhDgrive/Literatura/COPERT/ef_pc_may2018.csv", h=T)
ldv$EURO <- gsub(pattern = " ", replacement="", x = ldv$EURO)
hdv <- read.csv("~/MEGA/PhDgrive/Literatura/COPERT/ef_hdv.csv", h=T)
hdv$EURO <- gsub(pattern = " ", replacement="", x = hdv$EURO)
ev <- read.csv("~/MEGA/PhDgrive/Literatura/COPERT/ev_t2.csv", h=T)
bcom <- read.csv("~/MEGA/PhDgrive/Literatura/COPERT/bcom.csv", h=T)
cold <- read.csv("~/MEGA/PhDgrive/Literatura/COPERT/cold.csv", h=T)
iag <- read.csv("~/MEGA/PhDgrive/Literatura/COPERT/iag4.csv", h=T) #sergio
nox <- read.csv("~/MEGA/PhDgrive/Literatura/COPERT/nox.csv", h=T)
nitro <- read.csv("~/MEGA/PhDgrive/Literatura/COPERT/nitro.csv", h=T)
nmhc <- read.csv("~/MEGA/PhDgrive/Literatura/COPERT/nmhc.csv", h=T)
sysdata <- list(ldv, hdv, ev, bcom, cold, iag, nox, nitro, nmhc)
save(sysdata, file="~/Documentos/vein/R/sysdata.rda", compress = "xz")
devtools::load_all(".")
library(vein)
library(vein)
pkgdown:::build_site_rstudio()
